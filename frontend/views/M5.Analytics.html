<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>Manager Dashboard - Analytics</title>
    <link rel="stylesheet" href="../styles/style.css">
    <link rel="stylesheet" href="../styles/M0.Style.css">
    <link href='https://fonts.googleapis.com/css?family=Oswald' rel='stylesheet'>
    
    <style>
      /* Needed for pop-ups */
      .modal {
          display: none;
          justify-content: center;
          align-items: center; 
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          position: fixed;

          /* SAVE FOR LATER WHEN NEEDED IN ORDERS */
          /*background-color: rgba(0, 0, 0, 0.5);*/ /*Black background with opacity */
      }
      /* The modal content box */
      .modal-content {
          font-family: 'Oswald';
          background-color: #999999ff;
          padding: 0;
          border: 1px solid #888;
          width: 90%;
          max-width: 500px;
          margin: 0 auto;
          overflow: hidden; /* ensures buttons stay flush */
          display: flex;
          flex-direction: column;
      }
      
    </style>
  </head>

  <body>

    <!-- tab screen selection -->
    <div class="top-row">
      <div class="tab"><a href="M1.TableView.html"><h2>Table View</h2></a></div>
      <div class="tab"><a href="M2.Orders.html"><h2>Orders</h2></a></div>
      <div class="tab"><a href="M3.OrderHistory.html"><h2>Order History</h2></a></div>
      <div class="tab"><a href="M4.Inventory.html"><h2>Inventory</h2></a></div>
      <div class="selectedTab"><h2>Analytics</h2></div>
      <div class="tab"><a href="M6.EmployeeRegi.html"><h2>Employee Regi.</h2></a></div>
      <div class="tab"><a href="M7.ClockInHistory.html"><h2>Clock-In History</h2></a></div>
    </div>

    <!-- Dropdown list of months -->
    <div class="accordion-container">

      <!-- Year: 2025 -->
      <button class="accordion">- 2025</button>
      <div class="panel">

        <button class="accordion month">January</button>
        <div class="panel">
          <a href="#">1</a>
          <a href="#">2</a>
          <a href="#">3</a>
          <a href="#">4</a>
          <a href="#">5</a>
          <a href="#">6</a>
          <a href="#">7</a>
          <a href="#">8</a>
          <a href="#">9</a>
          <a href="#">10</a>
          <a href="#">11</a>
          <a href="#">12</a>
          <a href="#">13</a>
          <a href="#">14</a>
          <a href="#">15</a>
          <a href="#">16</a>
          <a href="#">17</a>
          <a href="#">18</a>
          <a href="#">19</a>
          <a href="#">20</a>
          <a href="#">21</a>
          <a href="#">22</a>
          <a href="#">23</a>
          <a href="#">24</a>
          <a href="#">25</a>
          <a href="#">26</a>
          <a href="#">27</a>
          <a href="#">28</a>
          <a href="#">29</a>
          <a href="#">30</a>
          <a href="#">31</a>
        </div>

        <button class="accordion month">February</button>
        <div class="panel">
          <a href="#">1</a>
          <a href="#">2</a>
          <a href="#">3</a>
          <a href="#">4</a>
          <a href="#">5</a>
          <a href="#">6</a>
          <a href="#">7</a>
          <a href="#">8</a>
          <a href="#">9</a>
          <a href="#">10</a>
          <a href="#">11</a>
          <a href="#">12</a>
          <a href="#">13</a>
          <a href="#">14</a>
          <a href="#">15</a>
          <a href="#">16</a>
          <a href="#">17</a>
          <a href="#">18</a>
          <a href="#">19</a>
          <a href="#">20</a>
          <a href="#">21</a>
          <a href="#">22</a>
          <a href="#">23</a>
          <a href="#">24</a>
          <a href="#">25</a>
          <a href="#">26</a>
          <a href="#">27</a>
          <a href="#">28</a>
          <a href="#">29</a>
        </div>

        <!-- Add additional months as needed -->

      </div>

      <!-- Year: 2024 -->
      <button class="accordion">- 2024</button>
      <div class="panel">
        <button class="accordion month">January</button>
        <div class="panel">
          <a href="#">1</a>
          <a href="#">2</a>
          <a href="#">3</a>
          <!-- etc. -->
        </div>
      </div>

      <!-- Year: 2023 -->
      <button class="accordion">- 2023</button>
      <div class="panel">
        <button class="accordion month">January</button>
        <div class="panel">
          <a href="#">1</a>
          <a href="#">2</a>
          <a href="#">3</a>
          <!-- etc. -->
        </div>
      </div>

      <!-- Year: 2022 -->
      <button class="accordion">- 2022</button>
      <div class="panel">
        <button class="accordion month">January</button>
        <div class="panel">
          <a href="#">1</a>
          <a href="#">2</a>
          <a href="#">3</a>
          <!-- etc. -->
        </div>
      </div>

      <!-- Year: 2021 -->
      <button class="accordion">- 2021</button>
      <div class="panel">
        <button class="accordion month">January</button>
        <div class="panel">
          <a href="#">1</a>
          <a href="#">2</a>
          <a href="#">3</a>
          <!-- etc. -->
        </div>
      </div>

      <!-- Year: 2020 -->
      <button class="accordion">- 2020</button>
      <div class="panel">
        <button class="accordion month">January</button>
        <div class="panel">
          <a href="#">1</a>
          <a href="#">2</a>
          <a href="#">3</a>
          <!-- etc. -->
        </div>
      </div>

      <!-- Year: 2019 -->
      <button class="accordion">- 2019</button>
      <div class="panel">
        <button class="accordion month">January</button>
        <div class="panel">
          <a href="#">1</a>
          <a href="#">2</a>
          <a href="#">3</a>
          <!-- etc. -->
        </div>
      </div>

      <!-- Year: 2018 -->
      <button class="accordion">- 2018</button>
      <div class="panel">
        <button class="accordion month">January</button>
        <div class="panel">
          <a href="#">1</a>
          <a href="#">2</a>
          <a href="#">3</a>
          <!-- etc. -->
        </div>
      </div>

      <!-- Year: 2017 -->
      <button class="accordion">- 2017</button>
      <div class="panel">
        <button class="accordion month">January</button>
        <div class="panel">
          <a href="#">1</a>
          <a href="#">2</a>
          <a href="#">3</a>
          <!-- etc. -->
        </div>
      </div>

    </div>

    <!-- Date Confirmation Pop-Up -->
    <div id="dateModal" class="modal">
      <div class="modal-content">
        <div class="modal-body" id="modalText">
          <!-- Date will be inserted dynamically -->
        </div>
        <div class="modal-buttons">
          <button class="back-button" id="cancelBtn">Back</button>
          <button class="confirm-button" id="confirmBtn">âœ“</button>
        </div>
      </div>
    </div>

    <!-- Opening dropdowns -->
    <script>
      const allAccordions = document.querySelectorAll(".accordion");
    
      allAccordions.forEach((accordion) => {
        accordion.addEventListener("click", function () {
          const isActive = this.classList.contains("active");
          const isMonth = this.classList.contains("month");
    
          // Close others at same level
          document.querySelectorAll(`.accordion${isMonth ? '.month' : ':not(.month)'}`).forEach(acc => {
            if (acc !== this) {
              acc.classList.remove("active");
              acc.nextElementSibling.style.display = "none";
            }
          });
    
          // Toggle current accordion
          if (!isActive) {
            this.classList.add("active");
            this.nextElementSibling.style.display = "block";
    
            // If this is a year accordion, collapse all child months inside it
            if (!isMonth) {
              const monthAccordions = this.nextElementSibling.querySelectorAll(".accordion.month");
              monthAccordions.forEach(month => {
                month.classList.remove("active");
                month.nextElementSibling.style.display = "none";
              });
            }
          } else {
            this.classList.remove("active");
            this.nextElementSibling.style.display = "none";
    
            // If this is a year accordion, collapse its child months too
            if (!isMonth) {
              const monthAccordions = this.nextElementSibling.querySelectorAll(".accordion.month");
              monthAccordions.forEach(month => {
                month.classList.remove("active");
                month.nextElementSibling.style.display = "none";
              });
            }
          }
        });
      });

      // Modal setup
      const modal = document.getElementById("dateModal");
      const modalText = document.getElementById("modalText");
      const cancelBtn = document.getElementById("cancelBtn");
      const confirmBtn = document.getElementById("confirmBtn");

      let selectedDate = null;

      // Attach event listeners to all day links
      document.querySelectorAll(".panel a").forEach(link => {
        link.addEventListener("click", function (event) {
          event.preventDefault(); // Prevent default navigation
          
          // Extract date path (year > month > day)
          const day = this.textContent.trim();
          const monthBtn = this.closest(".panel").previousElementSibling; // Month accordion
          const month = monthBtn.textContent.trim();
          const yearBtn = monthBtn.closest(".panel").previousElementSibling; // Year accordion
          const year = yearBtn.textContent.replace("-", "").trim();

          selectedDate = `${year} - ${month} ${day}`;
          modalText.innerHTML = `<h4>View analytics for ${selectedDate}?</h4>`;
          modal.style.display = "flex";
        });
      });

      // Modal button logic
      cancelBtn.onclick = () => {
        modal.style.display = "none";
        selectedDate = null;
      };

      confirmBtn.onclick = () => {
        modal.style.display = "none";

        // Handle confirmed date (you can replace this with actual logic)
        const dateParts = selectedDate.match(/(\d{4}) - (\w+) (\d{1,2})/);
        const [_, year, monthName, day] = dateParts;

        const monthMap = {
          January: "01", February: "02", March: "03", April: "04",
          May: "05", June: "06", July: "07", August: "08",
          September: "09", October: "10", November: "11", December: "12"
        };

        const formattedDate = `${year}-${monthMap[monthName]}-${String(day).padStart(2, '0')}`;

        // Save to localStorage and redirect to Table View
        localStorage.setItem("selectedAnalyticsDate", formattedDate);
        window.location.href = "M8.SampleReport.html";
      };
    </script>

  </body>

</html>
